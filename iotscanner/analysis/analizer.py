from nmap3 import Nmap


class DeviceAnalysis:

    def __init__(self, ip):
        self.ip = ip
        self.exposed_services = None

    def analyze(self):
        self.exposed_services = []
        nmap = Nmap()
        results = nmap.nmap_version_detection(self.ip, args="-Pn")
        for r in results:
            if 'service' in r:
                service_info = r['service']
                if 'product' in service_info:
                    service = service_info['product']
                    if 'version' in service_info:
                        service += " " + service_info['version']
                    self.exposed_services.append(service)

